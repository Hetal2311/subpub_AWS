import os
import sys
from datetime import datetime
from AWSIoTPythonSDK.MQTTLib import AWSIoTMQTTClient
import time
import json 

CA_PATH = "AmazonRootCA1.pem"
PRIVATE_KEY_PATH="98f510b5df-private.pem.key"
CERTIFICATE_PATH="98f510b5df-certificate.pem.crt"

myMQTTClient = AWSIoTMQTTClient("myClientID")

myMQTTClient.configureEndpoint("ahj3qmq1kli5n-ats.iot.ap-south-1.amazonaws.com",8883)
myMQTTClient.configureCredentials(CA_PATH,PRIVATE_KEY_PATH,CERTIFICATE_PATH)

myMQTTClient.configureAutoReconnectBackoffTime(1,32,20)
myMQTTClient.configureOfflinePublishQueueing(-1)
myMQTTClient.configureDrainingFrequency(2)
myMQTTClient.configureConnectDisconnectTimeout(10)
myMQTTClient.configureMQTTOperationTimeout(5)

print("Connect")
myMQTTClient.connect()
##loopcount = 0

message=json.dumps({"LED1":"0","LED2":"1","LED3":"0"})
while True:
    myMQTTClient.publish("pfc/test",message,1)
  ##  loopCount =loopCount+1
    time.sleep(1)
